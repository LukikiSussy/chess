<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="utf-8" />
    <title>Titulek</title>
 
    <style>
        .cell {
            width: 2vw;
            height: 2vw;
            border: solid black;
            border-width: 2px 2px 1px 1px;
        }

        .text {
            font-size: 50px;
            font-weight: bold;
            display: table-cell;
            row-gap: 100px;
        }

        .Row {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

    </style>
 
    <script>
        var id = null;

        fetch("http://localhost:3000/api/v1/game",{
            headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
            },
            method: "POST",
            body: JSON.stringify({a: "a"})
        })
        .then(async function(res){ 
            res = await res.json();

            id = res.gameId;

            console.log(res.board)

            for (let i = 7; i >= 0; i--) {
                let row = document.createElement("tr");
                for (let j = 0; j < 8; j++) {
                    let cell = document.createElement("td");
                    if((i+j) % 2 == 0) {
                        cell.style.backgroundColor = "brown";
                    }
                    cell.id = `cell${i}${j}`;
                    cell.classList.add("cell");
                    row.appendChild(cell);
                }
                document.body.appendChild(row);
            }

            updateBoard(res.board)
        })
        .catch(function(res){ console.log(res) })




        function send() {
            if(id == null) return;
            console.log(`http://localhost:3000/api/v1/game/${id}`)

            fetch(`http://localhost:3000/api/v1/game/${id}`,{
            headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
            },
            method: "POST",
            body: JSON.stringify({
                move: document.getElementById("input").value,
                gameId: id
        })
            })
            .then(async function(res){
                res = await res.json();

                console.log(res.game.board)
                console.log(res.moveStatus)
                console.log(res.game.currentPlayer)

                updateBoard(res.game.board)
            })
            .catch(function(res){ console.log(res) })
        }

        function updateBoard(board) {
            for (let i = 0; i < board.length; i++) {
                for (let j = 0; j < board[i].length; j++) {
                    if(board[i][j] != " ") {
                        document.getElementById(`cell${i}${j}`).innerHTML = board[i][j].type + " " + board[i][j].color;
                    }
                    else {
                        document.getElementById(`cell${i}${j}`).innerHTML = " "
                    }
                }
            }
        }
    </script>
</head>
 
<body>
    <input type="text" id="input">
    <button onclick="send()">send</button>
 
</body>
</html>

